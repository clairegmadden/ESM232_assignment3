---
title: "assignment3"
author: "Claire Madden"
date: "4/27/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(sensitivity)
library(pse)
library(here)


clim_data <- read_csv(here("Data", "clim.csv"))
```


Adjust your almond model to  output ONLY the mean almond yield anomoly IF the users sets parameter (e.g mean_only = TRUE))


Perform a sensitivity analysis of how mean anomaly varies ALL of the parameters used in the yield model  

Assume parameters are normally distribute with standard deviation of 20% mean value

```{r parameters}

# considering all parameters in the yield_anom model
factors <- c("tn1", "tn2", "p1", "p2", "int")

# number of parameter sets to run
nsets = 500

# set distributions

q = c("qnorm", "qnorm", "qnorm", "qnorm", "qnorm")

q.arg = list(list(mean = -0.015, sd = 0.2),
             list(mean = -0.0046, sd = 0.2),
             list(mean = -0.07, sd= 0.2),
             list(mean = 0.0043, sd = 0.2),
             list(mean = 0.28, sd = 0.2))



# generate samples from LHS
sens1 <- LHS(NULL, factors, nsets, q, q.arg)

sens_pars <- get.data(sens1)


# create matrix to store results
sens1_results <- matrix(nrow = nsets, ncol = 5)

# read in input data in set up code chunk as 'clim_data'



```


Rank the parameters in term of their sensitivity

Graph uncertainty in mean yield anomaly across all parameter uncertainty (boxplot and cummulative distribution of the output).



Repeat using the LHS and Sobel methods



Repeat using twice as many parameter sets as you did in your first sensitivity analysis - and look at how this changes the sensitivity results



Submit R markdown and short write up describing what you learned from the sensitivity analysis. Please submit your markdown as an .html or PDF. 

```{r}

source("../R/yield_anom.R")


```




